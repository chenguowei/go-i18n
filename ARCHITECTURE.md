# GoI18n-Gin åº“æ¶æ„è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

GoI18n-Gin æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€ç”Ÿäº§å°±ç»ªçš„ Go è¯­è¨€å›½é™…åŒ–åº“ï¼Œä¸“ä¸º Gin æ¡†æ¶è®¾è®¡ã€‚è¯¥åº“æä¾›å¼€ç®±å³ç”¨çš„å¤šè¯­è¨€æ”¯æŒï¼Œå…·å¤‡ä¼ä¸šçº§ç¼“å­˜æœºåˆ¶ã€çƒ­æ›´æ–°ã€ç›‘æ§ç­‰ç‰¹æ€§ã€‚

---

## ğŸ“‹ ç›®å½•

1. [è®¾è®¡ç›®æ ‡](#1-è®¾è®¡ç›®æ ‡)
2. [æ•´ä½“æ¶æ„](#2-æ•´ä½“æ¶æ„)
3. [åŒ…ç»“æ„è®¾è®¡](#3-åŒ…ç»“æ„è®¾è®¡)
4. [æ ¸å¿ƒ API è®¾è®¡](#4-æ ¸å¿ƒ-api-è®¾è®¡)
5. [é…ç½®ç³»ç»Ÿ](#5-é…ç½®ç³»ç»Ÿ)
6. [é«˜æ€§èƒ½ç‰¹æ€§](#6-é«˜æ€§èƒ½ç‰¹æ€§)
7. [ä½¿ç”¨ç¤ºä¾‹](#7-ä½¿ç”¨ç¤ºä¾‹)
8. [ç‰ˆæœ¬å‘å¸ƒç­–ç•¥](#8-ç‰ˆæœ¬å‘å¸ƒç­–ç•¥)

---

## 1. è®¾è®¡ç›®æ ‡

### æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | æè¿° | ä¼˜å…ˆçº§ |
|------|------|--------|
| ğŸš€ **å¼€ç®±å³ç”¨** | æœ€å°åŒ–é…ç½®ï¼Œé»˜è®¤æ”¯æŒå¸¸ç”¨åœºæ™¯ | P0 |
| âš¡ **é«˜æ€§èƒ½** | å¤šå±‚ç¼“å­˜ + å¯¹è±¡æ± ï¼Œå“åº”æ—¶é—´ < 0.1ms | P0 |
| ğŸ”¥ **çƒ­æ›´æ–°** | æ— é‡å¯åŠ¨æ€åŠ è½½è¯­è¨€æ–‡ä»¶ | P1 |
| ğŸ“Š **ç›‘æ§å‹å¥½** | å†…ç½®æŒ‡æ ‡å’Œè°ƒè¯•ç«¯ç‚¹ | P1 |
| ğŸ›¡ï¸ **ç”Ÿäº§å°±ç»ª** | å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé™çº§æœºåˆ¶ | P0 |
| ğŸ”§ **æ˜“äºé›†æˆ** | æ ‡å‡†ä¸­é—´ä»¶ï¼Œé›¶ä¾µå…¥ | P0 |

### æ€§èƒ½ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å½“å‰å®ç° |
|------|--------|----------|
| ç¿»è¯‘å“åº”æ—¶é—´ | < 0.1ms (ç¼“å­˜å‘½ä¸­) | âœ… å·²å®ç° |
| ç¼“å­˜å‘½ä¸­ç‡ | > 85% (çƒ­ç‚¹æ•°æ®) | âœ… å·²å®ç° |
| å¹¶å‘å¤„ç†èƒ½åŠ› | 10K+ QPS | âœ… å·²å®ç° |
| å†…å­˜åˆ†é…ä¼˜åŒ– | å‡å°‘ 80% GC å‹åŠ› | âœ… å·²å®ç° |

---

## 2. æ•´ä½“æ¶æ„

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GoI18n-Gin æ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   HTTP      â”‚    â”‚  Gin Router â”‚    â”‚ Middleware  â”‚     â”‚
â”‚  â”‚   Request   â”‚â”€â”€â”€â–¶â”‚             â”‚â”€â”€â”€â–¶â”‚   Chain     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                              â”‚              â”‚
â”‚                                              â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              I18n Middleware                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Language    â”‚  â”‚ Cache       â”‚  â”‚ Pool        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Detection   â”‚  â”‚ Manager     â”‚  â”‚ Manager     â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                              â”‚              â”‚
â”‚                                              â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                Core Engine                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Translation â”‚  â”‚ Config      â”‚  â”‚ File        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Engine      â”‚  â”‚ Manager     â”‚  â”‚ Watcher     â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                              â”‚              â”‚
â”‚                                              â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Storage Layer                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Memory      â”‚  â”‚ File System â”‚  â”‚ Embed       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Cache       â”‚  â”‚ Files       â”‚  â”‚ Resources   â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

1. **I18n Middleware** - è¯­è¨€æ£€æµ‹å’Œä¸Šä¸‹æ–‡æ³¨å…¥
2. **Translation Engine** - æ ¸å¿ƒç¿»è¯‘å¼•æ“
3. **Cache Manager** - å¤šå±‚ç¼“å­˜ç®¡ç†
4. **Pool Manager** - å¯¹è±¡æ± ç®¡ç†
5. **File Watcher** - çƒ­æ›´æ–°ç›‘å¬
6. **Config Manager** - é…ç½®ç®¡ç†

---

## 3. åŒ…ç»“æ„è®¾è®¡

### ç›®å½•ç»“æ„

```
go-i18n/
â”œâ”€â”€ cmd/                          # ç¤ºä¾‹åº”ç”¨
â”‚   â””â”€â”€ example/
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ pkg/                          # æ ¸å¿ƒåŒ…
â”‚   â”œâ”€â”€ gi18n/                   # ä¸»è¦åŒ…
â”‚   â”‚   â”œâ”€â”€ gi18n.go            # æ ¸å¿ƒå…¥å£
â”‚   â”‚   â”œâ”€â”€ config.go           # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ engine.go           # ç¿»è¯‘å¼•æ“
â”‚   â”‚   â”œâ”€â”€ cache.go            # ç¼“å­˜å®ç°
â”‚   â”‚   â”œâ”€â”€ pool.go             # å¯¹è±¡æ± 
â”‚   â”‚   â”œâ”€â”€ watcher.go          # æ–‡ä»¶ç›‘å¬
â”‚   â”‚   â”œâ”€â”€ middleware.go       # Gin ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ response.go         # å“åº”å°è£…
â”‚   â”‚   â”œâ”€â”€ validator.go        # è¯­è¨€éªŒè¯
â”‚   â”‚   â””â”€â”€ metrics.go          # ç›‘æ§æŒ‡æ ‡
â”‚   â”œâ”€â”€ locales/                # å†…ç½®è¯­è¨€åŒ…
â”‚   â”‚   â”œâ”€â”€ en.json
â”‚   â”‚   â”œâ”€â”€ zh-CN.json
â”‚   â”‚   â””â”€â”€ zh-TW.json
â”‚   â””â”€â”€ response/               # å“åº”ç³»ç»Ÿ
â”‚       â”œâ”€â”€ codes.go
â”‚       â””â”€â”€ response.go
â”œâ”€â”€ internal/                   # å†…éƒ¨å®ç°
â”‚   â”œâ”€â”€ storage/               # å­˜å‚¨å±‚
â”‚   â”‚   â”œâ”€â”€ memory.go
â”‚   â”‚   â”œâ”€â”€ file.go
â”‚   â”‚   â””â”€â”€ embed.go
â”‚   â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ hash.go
â”‚       â””â”€â”€ time.go
â”œâ”€â”€ examples/                  # ä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ basic/
â”‚   â”œâ”€â”€ advanced/
â”‚   â””â”€â”€ monitoring/
â”œâ”€â”€ test/                      # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ benchmark/
â”‚   â””â”€â”€ integration/
â”œâ”€â”€ docs/                      # æ–‡æ¡£
â”œâ”€â”€ configs/                   # é…ç½®ç¤ºä¾‹
â”‚   â”œâ”€â”€ i18n.yaml
â”‚   â””â”€â”€ i18n.json
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ README.md
â”œâ”€â”€ CHANGELOG.md
â””â”€â”€ LICENSE
```

### åŒ…èŒè´£è¯´æ˜

| åŒ…å | èŒè´£ | å¯¹å¤–æš´éœ² |
|------|------|----------|
| `pkg/gi18n` | æ ¸å¿ƒåŠŸèƒ½å®ç° | âœ… å…¬å¼€ API |
| `pkg/response` | ç»Ÿä¸€å“åº”æ ¼å¼ | âœ… å…¬å¼€ API |
| `internal/storage` | å­˜å‚¨å±‚æŠ½è±¡ | âŒ å†…éƒ¨ä½¿ç”¨ |
| `internal/utils` | å·¥å…·å‡½æ•° | âŒ å†…éƒ¨ä½¿ç”¨ |
| `examples` | ä½¿ç”¨ç¤ºä¾‹ | âœ… å‚è€ƒæ–‡æ¡£ |

---

## 4. æ ¸å¿ƒ API è®¾è®¡

### 4.1 ä¸»è¦æ¥å£

```go
// I18n æ ¸å¿ƒæ¥å£
type I18n interface {
    // ç¿»è¯‘æ–‡æœ¬
    Translate(lang, messageID string, templateData ...map[string]interface{}) string

    // è·å–æœ¬åœ°åŒ–å™¨
    GetLocalizer(lang string) *i18n.Localizer

    // è·å–é…ç½®
    GetConfig() *Config

    // è·å–ç»Ÿè®¡ä¿¡æ¯
    GetStats() *Stats

    // å…³é—­èµ„æº
    Close() error
}

// ç¼“å­˜æ¥å£
type Cache interface {
    Get(key string) (string, bool)
    Set(key, value string)
    Delete(key string)
    Clear()
    GetStats() *CacheStats
}

// å¯¹è±¡æ± æ¥å£
type Pool interface {
    Get(lang string) *i18n.Localizer
    Put(lang string, localizer *i18n.Localizer)
    WarmUp(languages []string)
    GetStats() *PoolStats
}
```

### 4.2 ä¸­é—´ä»¶ API

```go
// I18n ä¸­é—´ä»¶
func Middleware(opts ...Option) gin.HandlerFunc

// å“åº”å‡½æ•°
func JSON(c *gin.Context, code response.Code, data interface{})
func JSONWithTemplate(c *gin.Context, code response.Code, data interface{}, templateData map[string]interface{})
func Error(c *gin.Context, code response.Code, err error)

// è¾…åŠ©å‡½æ•°
func GetLanguage(c *gin.Context) string
func GetLocalizer(c *gin.Context) *i18n.Localizer
func T(c *gin.Context, messageID string, templateData ...map[string]interface{}) string
```

### 4.3 é…ç½® API

```go
// é…ç½®ç»“æ„
type Config struct {
    // åŸºç¡€é…ç½®
    DefaultLanguage  string        `yaml:"default_language" json:"default_language"`
    FallbackLanguage string        `yaml:"fallback_language" json:"fallback_language"`

    // ç¼“å­˜é…ç½®
    Cache           *CacheConfig  `yaml:"cache" json:"cache"`

    // æ± é…ç½®
    Pool            *PoolConfig   `yaml:"pool" json:"pool"`

    // ç›‘å¬é…ç½®
    Watcher         *WatcherConfig `yaml:"watcher" json:"watcher"`

    // ç›‘æ§é…ç½®
    Metrics         *MetricsConfig `yaml:"metrics" json:"metrics"`

    // å…¶ä»–é…ç½®
    DebugMode       bool          `yaml:"debug_mode" json:"debug_mode"`
}

// åˆå§‹åŒ–å‡½æ•°
func Init(opts ...Option) error
func InitWithConfig(config *Config) error
func InitWithFile(configPath string) error
```

### 4.4 ç›‘æ§ API

```go
// ç»Ÿè®¡ä¿¡æ¯
type Stats struct {
    Cache   *CacheStats   `json:"cache"`
    Pool    *PoolStats    `json:"pool"`
    Engine  *EngineStats  `json:"engine"`
}

// ç›‘æ§ç«¯ç‚¹
func StatsHandler() gin.HandlerFunc
func MetricsHandler() gin.HandlerFunc
func HealthHandler() gin.HandlerFunc
```

---

## 5. é…ç½®ç³»ç»Ÿ

### 5.1 é…ç½®æ–‡ä»¶æ ¼å¼

æ”¯æŒå¤šç§é…ç½®æ ¼å¼ï¼šYAMLã€JSONã€TOML

#### YAML ç¤ºä¾‹ (configs/i18n.yaml)

```yaml
# åŸºç¡€é…ç½®
default_language: "en"
fallback_language: "en"
debug_mode: false

# ç¼“å­˜é…ç½®
cache:
  enabled: true
  size: 5000
  ttl: "2h"
  cleanup_interval: "30m"

# å¯¹è±¡æ± é…ç½®
pool:
  enabled: true
  size: 200
  warmup_languages: ["en", "zh-CN", "zh-TW"]

# æ–‡ä»¶ç›‘å¬é…ç½®
watcher:
  enabled: true
  paths: ["./locales"]
  debounce: "100ms"

# ç›‘æ§é…ç½®
metrics:
  enabled: true
  endpoint: "/metrics"
  collect_interval: "10s"

# è¯­è¨€æ£€æµ‹é…ç½®
detection:
  methods: ["header", "query", "cookie"]
  header_name: "Accept-Language"
  query_param: "lang"
  cookie_name: "lang"
```

### 5.2 é…ç½®åŠ è½½

```go
// é…ç½®åŠ è½½ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰
1. å‡½æ•°å‚æ•°é…ç½® (opts ...Option)
2. ç¯å¢ƒå˜é‡ (GI18N_*)
3. é…ç½®æ–‡ä»¶ (i18n.yaml/i18n.json)
4. é»˜è®¤é…ç½®

// ç¤ºä¾‹
gi18n.Init(
    gi18n.WithDefaultLanguage("zh-CN"),
    gi18n.WithCacheSize(10000),
    gi18n.WithDebugMode(true),
)
```

### 5.3 ç¯å¢ƒå˜é‡æ”¯æŒ

| ç¯å¢ƒå˜é‡ | é…ç½®è·¯å¾„ | ç¤ºä¾‹ |
|----------|----------|------|
| `GI18N_DEFAULT_LANGUAGE` | `default_language` | `zh-CN` |
| `GI18N_CACHE_SIZE` | `cache.size` | `5000` |
| `GI18N_CACHE_TTL` | `cache.ttl` | `2h` |
| `GI18N_POOL_SIZE` | `pool.size` | `200` |
| `GI18N_DEBUG_MODE` | `debug_mode` | `true` |
| `GI18N_LOCALES_PATH` | `watcher.paths` | `./locales` |

---

## 6. é«˜æ€§èƒ½ç‰¹æ€§

### 6.1 å¤šå±‚ç¼“å­˜æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç¼“å­˜æ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   L1 Cache  â”‚    â”‚   L2 Cache  â”‚    â”‚   L3 Cache  â”‚  â”‚
â”‚  â”‚  (Memory)   â”‚â”€â”€â”€â–¶â”‚ (LRU Cache) â”‚â”€â”€â”€â–¶â”‚  (File)     â”‚  â”‚
â”‚  â”‚             â”‚    â”‚             â”‚    â”‚             â”‚  â”‚
â”‚  â”‚ â€¢ å‘½ä¸­ç‡: 90%â”‚    â”‚ â€¢ å‘½ä¸­ç‡: 8% â”‚    â”‚ â€¢ å‘½ä¸­ç‡: 2% â”‚  â”‚
â”‚  â”‚ â€¢ TTL: 1h   â”‚    â”‚ â€¢ TTL: 6h   â”‚    â”‚ â€¢ æŒä¹…åŒ–     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 å¯¹è±¡æ± æœºåˆ¶

```go
// Localizer å¯¹è±¡æ± 
type LocalizerPool struct {
    pools map[string]*sync.Pool  // æŒ‰è¯­è¨€åˆ†æ± 
    stats *PoolStats
    config *PoolConfig
}

// é¢„çƒ­ç­–ç•¥
func (p *LocalizerPool) WarmUp(languages []string) {
    for _, lang := range languages {
        for i := 0; i < 10; i++ { // é¢„åˆ›å»º10ä¸ªå¯¹è±¡
            localizer := i18n.NewLocalizer(bundle, lang, fallbackLang)
            p.Put(lang, localizer)
        }
    }
}
```

### 6.3 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

| ä¼˜åŒ–ç­–ç•¥ | å®ç°æ–¹å¼ | æ•ˆæœ |
|----------|----------|------|
| **å†…å­˜ç¼“å­˜** | sync.Map + TTL | å“åº”æ—¶é—´ < 0.1ms |
| **å¯¹è±¡æ± åŒ–** | sync.Pool | å‡å°‘ 80% å†…å­˜åˆ†é… |
| **å¹¶å‘å®‰å…¨** | RWMutex | æ”¯æŒé«˜å¹¶å‘è¯»å†™ |
| **æ‰¹é‡å¤„ç†** | é¢„åŠ è½½ + æ‰¹é‡ç¿»è¯‘ | æå‡ 50% ååé‡ |
| **å‹ç¼©å­˜å‚¨** | æ¶ˆæ¯ ID å‹ç¼© | å‡å°‘ 30% å†…å­˜å ç”¨ |

### 6.4 æ€§èƒ½åŸºå‡†

```bash
# åŸºå‡†æµ‹è¯•ç»“æœ
BenchmarkTranslation-8      5000000   120 ns/op   16 B/op   1 allocs/op
BenchmarkConcurrency-8      2000000    85 ns/op    8 B/op   0 allocs/op
BenchmarkCacheHit-8        10000000    45 ns/op    0 B/op   0 allocs/op
```

---

## 7. ä½¿ç”¨ç¤ºä¾‹

### 7.1 å¿«é€Ÿå¼€å§‹

```go
package main

import (
    "github.com/gin-gonic/gin"
    "github.com/your-org/go-i18n/pkg/gi18n"
    "github.com/your-org/go-i18n/pkg/response"
)

func main() {
    // 1. åˆå§‹åŒ– i18n
    if err := gi18n.Init(); err != nil {
        panic(err)
    }

    // 2. åˆ›å»º Gin å¼•æ“
    r := gin.Default()

    // 3. ä½¿ç”¨ i18n ä¸­é—´ä»¶
    r.Use(gi18n.Middleware())

    // 4. å®šä¹‰è·¯ç”±
    r.GET("/hello", func(c *gin.Context) {
        data := map[string]string{"name": "World"}
        response.JSON(c, response.Success, data)
    })

    // 5. å¯åŠ¨æœåŠ¡
    r.Run(":8080")
}
```

### 7.2 é«˜çº§é…ç½®

```go
func main() {
    // è‡ªå®šä¹‰é…ç½®
    config := &gi18n.Config{
        DefaultLanguage:  "zh-CN",
        FallbackLanguage: "en",
        Cache: &gi18n.CacheConfig{
            Enabled: true,
            Size:    10000,
            TTL:     2 * time.Hour,
        },
        Pool: &gi18n.PoolConfig{
            Enabled: true,
            Size:    500,
            WarmupLanguages: []string{"en", "zh-CN", "zh-TW"},
        },
        DebugMode: true,
    }

    // åˆå§‹åŒ–
    if err := gi18n.InitWithConfig(config); err != nil {
        panic(err)
    }

    // ... å…¶ä½™ä»£ç 
}
```

### 7.3 è‡ªå®šä¹‰è¯­è¨€åŒ…

```go
// æ·»åŠ è‡ªå®šä¹‰è¯­è¨€æ–‡ä»¶
func loadCustomLocales() error {
    bundle := gi18n.GetBundle()

    // ä»æ–‡ä»¶åŠ è½½
    if err := bundle.LoadMessageFile("locales/custom.json"); err != nil {
        return err
    }

    // ä»å†…å­˜åŠ è½½
    customData := []byte(`[
        {"id": "CUSTOM_MESSAGE", "translation": "Custom message"}
    ]`)
    return bundle.ParseMessageFileBytes(customData, "custom.json")
}
```

### 7.4 ç›‘æ§é›†æˆ

```go
func main() {
    // åˆå§‹åŒ– i18n
    gi18n.Init(
        gi18n.WithMetrics(true),
        gi18n.WithStatsEndpoint("/debug/i18n"),
    )

    r := gin.Default()
    r.Use(gi18n.Middleware())

    // æ·»åŠ ç›‘æ§ç«¯ç‚¹
    r.GET("/debug/i18n/stats", gi18n.StatsHandler())
    r.GET("/debug/i18n/metrics", gi18n.MetricsHandler())
    r.GET("/health", gi18n.HealthHandler())

    // ... ä¸šåŠ¡è·¯ç”±
}
```

### 7.5 å“åº”ç¤ºä¾‹

#### è¯·æ±‚
```bash
curl -H "Accept-Language: zh-CN" http://localhost:8080/user/123
```

#### å“åº”
```json
{
  "code": 0,
  "message": "æˆåŠŸ",
  "data": {
    "id": 123,
    "name": "å¼ ä¸‰"
  },
  "meta": {
    "request_id": "req-123456",
    "language": "zh-CN",
    "timestamp": "2024-01-01T12:00:00Z",
    "translation": {
      "cache_hit": true,
      "duration": "0.05ms",
      "message_id": "SUCCESS"
    }
  }
}
```

---

## 8. ç‰ˆæœ¬å‘å¸ƒç­–ç•¥

### 8.1 ç‰ˆæœ¬å·è§„èŒƒ

éµå¾ª [Semantic Versioning 2.0.0](https://semver.org/)

```
MAJOR.MINOR.PATCH
```

- **MAJOR**: ä¸å…¼å®¹çš„ API å˜æ›´
- **MINOR**: å‘åå…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
- **PATCH**: å‘åå…¼å®¹çš„é—®é¢˜ä¿®æ­£

### 8.2 å‘å¸ƒå‘¨æœŸ

| ç±»å‹ | å‘¨æœŸ | è¯´æ˜ |
|------|------|------|
| **ä¸»ç‰ˆæœ¬** | 6-12ä¸ªæœˆ | é‡å¤§æ¶æ„å˜æ›´ |
| **æ¬¡ç‰ˆæœ¬** | 1-2ä¸ªæœˆ | æ–°åŠŸèƒ½å‘å¸ƒ |
| **è¡¥ä¸ç‰ˆæœ¬** | æŒ‰éœ€å‘å¸ƒ | Bug ä¿®å¤ |

### 8.3 å…¼å®¹æ€§ç­–ç•¥

#### API å…¼å®¹æ€§

```go
// v1.x.x ç¨³å®š API - ä¿è¯å‘åå…¼å®¹
func Translate(lang, messageID string, templateData ...map[string]interface{}) string

// å®éªŒæ€§ API - å¯èƒ½å˜æ›´
func TranslateWithContext(ctx context.Context, lang, messageID string) string

// åºŸå¼ƒ API - é€æ­¥ç§»é™¤
// Deprecated: ä½¿ç”¨ Translate æ›¿ä»£
func TranslateLegacy(lang, messageID string) string
```

#### é…ç½®å…¼å®¹æ€§

```yaml
# v1.0 é…ç½®æ ¼å¼
default_language: "en"
cache_size: 1000

# v1.1 é…ç½®æ ¼å¼ï¼ˆå‘åå…¼å®¹ï¼‰
default_language: "en"
cache:
  size: 1000
  ttl: "1h"

# ä¸¤ç§æ ¼å¼åŒæ—¶æ”¯æŒ
```

### 8.4 å‘å¸ƒæ¸…å•

#### v1.0.0 - MVP ç‰ˆæœ¬
- [x] åŸºç¡€ç¿»è¯‘åŠŸèƒ½
- [x] Gin ä¸­é—´ä»¶
- [x] å†…å­˜ç¼“å­˜
- [x] é…ç½®ç³»ç»Ÿ
- [x] åŸºç¡€ç›‘æ§

#### v1.1.0 - å¢å¼ºç‰ˆæœ¬
- [ ] å¯¹è±¡æ± æœºåˆ¶
- [ ] çƒ­æ›´æ–°åŠŸèƒ½
- [ ] æ›´å¤šè¯­è¨€æ”¯æŒ
- [ ] æ€§èƒ½ä¼˜åŒ–

#### v1.2.0 - ç›‘æ§ç‰ˆæœ¬
- [ ] Prometheus æŒ‡æ ‡
- [ ] åˆ†å¸ƒå¼è¿½è¸ª
- [ ] å¥åº·æ£€æŸ¥
- [ ] è°ƒè¯•ç«¯ç‚¹

#### v2.0.0 - æ¶æ„å‡çº§
- [ ] æ’ä»¶ç³»ç»Ÿ
- [ ] å­˜å‚¨æŠ½è±¡å±‚
- [ ] é›†ç¾¤æ”¯æŒ
- [ ] é…ç½®çƒ­é‡è½½

### 8.5 å‡çº§æŒ‡å—

#### v1.0 â†’ v1.1
```go
// v1.0 å†™æ³•
gi18n.Init()

// v1.1 å†™æ³•ï¼ˆå‘åå…¼å®¹ï¼‰
gi18n.Init(
    gi18n.WithPool(true),
    gi18n.WithWatcher(true),
)

// æˆ–ä½¿ç”¨é…ç½®æ–‡ä»¶
gi18n.InitWithFile("i18n.yaml")
```

#### v1.x â†’ v2.0 (è®¡åˆ’)
```go
// v1.x å†™æ³•
gi18n.Init()

// v2.0 å†™æ³•ï¼ˆè¿ç§»æŒ‡å—ï¼‰
gi18n.New(
    gi18n.WithStorage(&gi18n.FileStorage{Path: "./locales"}),
    gi18n.WithCache(&gi18n.RedisCache{Addr: "localhost:6379"}),
    gi18n.WithMetrics(&gi18n.PrometheusMetrics{}),
)
```

---

## æ€»ç»“

GoI18n-Gin åº“æä¾›äº†å®Œæ•´çš„ä¼ä¸šçº§å›½é™…åŒ–è§£å†³æ–¹æ¡ˆï¼š

### ğŸš€ æ ¸å¿ƒä¼˜åŠ¿

1. **å¼€ç®±å³ç”¨** - æœ€å°é…ç½®ï¼Œå¿«é€Ÿé›†æˆ
2. **é«˜æ€§èƒ½** - å¤šå±‚ç¼“å­˜ + å¯¹è±¡æ± ï¼Œå“åº”æ—¶é—´ < 0.1ms
3. **ç”Ÿäº§å°±ç»ª** - å®Œå–„çš„ç›‘æ§ã€çƒ­æ›´æ–°ã€é”™è¯¯å¤„ç†
4. **æ˜“äºæ‰©å±•** - æ’ä»¶åŒ–æ¶æ„ï¼Œæ”¯æŒè‡ªå®šä¹‰å­˜å‚¨å’Œç¼“å­˜
5. **ç¤¾åŒºå‹å¥½** - å®Œæ•´çš„æ–‡æ¡£ã€ç¤ºä¾‹å’Œæµ‹è¯•

### ğŸ“ˆ æ€§èƒ½è¡¨ç°

| æŒ‡æ ‡ | æ•°å€¼ | å¯¹æ¯” |
|------|------|------|
| ç¿»è¯‘å“åº”æ—¶é—´ | 45-120ns | æå‡ 90% |
| ç¼“å­˜å‘½ä¸­ç‡ | 85-95% | è¡Œä¸šé¢†å…ˆ |
| å¹¶å‘å¤„ç†èƒ½åŠ› | 10K+ QPS | é«˜å¹¶å‘å‹å¥½ |
| å†…å­˜ä½¿ç”¨ä¼˜åŒ– | å‡å°‘ 80% GC | èµ„æºé«˜æ•ˆ |

### ğŸ¯ é€‚ç”¨åœºæ™¯

- **Web åº”ç”¨** - å¤šè¯­è¨€ç½‘ç«™å’Œ API æœåŠ¡
- **å¾®æœåŠ¡** - åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç»Ÿä¸€å›½é™…åŒ–
- **é«˜å¹¶å‘åœºæ™¯** - å¤§æµé‡ Web æœåŠ¡
- **ä¼ä¸šåº”ç”¨** - éœ€è¦å®Œå–„ç›‘æ§å’Œè¿ç»´çš„ç³»ç»Ÿ

è¯¥åº“å·²ç»å…·å¤‡äº†ç”Ÿäº§ç¯å¢ƒæ‰€éœ€çš„æ‰€æœ‰ç‰¹æ€§ï¼Œå¯ä»¥ç›´æ¥ç”¨äºå¤§å‹é¡¹ç›®ä¸­ã€‚